# 短链管理

基础包提供短链管理功能，可生成分享链接的短链，包括web分享短链，小程序分享短链，APP分享短链

使用代码示例：

```java
AppRouter router = IApplicationService.get().buildAppRouter(title, viewModel, viewCode, modelId, uuid);
		String routerShortLink = AppCacheUtil.buildRouterShortLink(router);
		ShareLinkType shareLinkType = input.getShareLinkTypeEnum();
		if(shareLinkType == ShareLinkType.MiniProgram) {
			Map<String,Object> projectConfig = new LinkedHashMap<>();
			//ws请求链接
			String wsUrl = QueryWebSocketConnectUrl.query(panelContext);
			projectConfig.put("url", wsUrl);
			projectConfig.put("cell", IAppFeLoginPage.class.getName());
			Map<String,Object> initParam = new LinkedHashMap<>();
			initParam.put(AppCacheUtil.InitParam_SystemUuid, shareAppSetting.getUuid());
			initParam.put(AppCacheUtil.InitParam_AppCode, shareAppSetting.getName());
			initParam.put(AppCacheUtil.InitParam_AppSessionKey, shareAppSetting.getSessionKey());
			try(IJson json = IJsonService.get().getJson()){
				initParam.put(AppCacheUtil.InitParam_RouterShortLink, routerShortLink);
				projectConfig.put("initParam", initParam);
			}
			String appId = input.getAppIdVarValue();//
			if(CmnUtil.isStringEmpty(appId))
				throw new VerifyException("小程序appId未配置，请先配置！");
			String envVersion = input.getEnvVersionVarValue();
			String weAppLink = IShortLinkService.get().buildMiniProgramLink(appId, projectConfig,envVersion);
			shareLink = IShortLinkService.get().buildMiniProgramShortLink(shortLinkServerUrl,weAppLink);
		}else if(shareLinkType == ShareLinkType.APP) {
			if(CmnUtil.isStringEmpty(appShortLink)) {
				throw new VerifyException("APP短链未配置！");
			}
			String appLink = appShortLink + "/detail?query=#query#";
			Map<String,String> regexMap = new LinkedHashMap<>();
			regexMap.put("#query#", routerShortLink);
			String weAppLink = ToolUtilities.replaceAll(appLink, regexMap);
			shareLink = IShortLinkService.get().buildMiniProgramShortLink(shortLinkServerUrl,weAppLink);
			shareLink = shortLinkServerUrl + "/jumpApp.html?appCode="+shareAppCode+"&appLink="+weAppLink;

		}else if(shareLinkType == ShareLinkType.Url) {
			shareLink = shortLinkServerUrl+"/" + shareAppCode + "/detail?query=#query#";
			Map<String,String> regexMap = new LinkedHashMap<>();
			regexMap.put("#query#", routerShortLink);
			shareLink = ToolUtilities.replaceAll(shareLink, regexMap);
		}
```

